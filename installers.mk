$(MAKEMAGIC_DIR)makemagic/installers.proc: $(MAKEMAGIC_DIR)makemagic/installers.raw
	@cat $< \
	| python -c 'MARKER="command"; EXISTS_FN = "%s_EXISTS" % MARKER.upper(); import re; import sys; filecont = sys.stdin.read(); filecont = re.sub("^%s: (.*) name: (.*)" % MARKER, "ifeq ($$(call %s,\\1),1)\\n\\2 = \\2.$(OS)\\nendif" % EXISTS_FN, filecont, flags=re.MULTILINE); filecont = re.sub("^%s: (.*)" % MARKER, "ifeq ($$(call %s,\\1),1)\\n\\1 = \\1.$(OS)\\nendif" % EXISTS_FN, filecont, flags=re.MULTILINE); print(filecont)' \
	| python -c 'MARKER="pymodule"; EXISTS_FN = "%s_EXISTS" % MARKER.upper(); import re; import sys; filecont = sys.stdin.read(); filecont = re.sub("^%s: (.*) name: (.*)" % MARKER, "ifeq ($$(call %s,\\1),1)\\n\\2 = \\2.$(OS)\\nendif" % EXISTS_FN, filecont, flags=re.MULTILINE); filecont = re.sub("^%s: (.*)" % MARKER, "ifeq ($$(call %s,\\1),1)\\n\\1 = \\1.$(OS)\\nendif" % EXISTS_FN, filecont, flags=re.MULTILINE); print(filecont)' \
	| python -c 'MARKER="library"; EXISTS_FN = "%s_EXISTS" % MARKER.upper(); import re; import sys; filecont = sys.stdin.read(); filecont = re.sub("^%s: (.*) name: (.*)" % MARKER, "ifeq ($$(call %s,\\1),1)\\n\\2 = \\2.$(OS)\\nendif" % EXISTS_FN, filecont, flags=re.MULTILINE); filecont = re.sub("^%s: (.*)" % MARKER, "ifeq ($$(call %s,\\1),1)\\n\\1 = \\1.$(OS)\\nendif" % EXISTS_FN, filecont, flags=re.MULTILINE); print(filecont)' \
	| python -c 'MARKER="file"; EXISTS_FN = "%s_EXISTS" % MARKER.upper(); import re; import sys; filecont = sys.stdin.read(); filecont = re.sub("^%s: (.*) name: (.*)" % MARKER, "ifeq ($$(call %s,\\1),1)\\n\\2 = \\2.$(OS)\\nendif" % EXISTS_FN, filecont, flags=re.MULTILINE); filecont = re.sub("^%s: (.*)" % MARKER, "ifeq ($$(call %s,\\1),1)\\n\\1 = \\1.$(OS)\\nendif" % EXISTS_FN, filecont, flags=re.MULTILINE); print(filecont)' \
	> $@

include $(MAKEMAGIC_DIR)makemagic/installers.proc